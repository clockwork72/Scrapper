version: 0.1

# Deterministic normalization rules.
# If multiple matches occur: prefer longer match, then more specific term.
# If still ambiguous, keep raw label and mark unknown.

lexicon:
  actions:
    - match: "\\bshare(d|s|ing)?\\b"
      map_to: action:share
    - match: "\\bdisclos(e|ed|ing)\\b"
      map_to: action:share
    - match: "\\bcollect(s|ed|ing)?\\b"
      map_to: action:collect
    - match: "\\buse(s|d|ing)?\\b"
      map_to: action:use
    - match: "\\bretain(s|ed|ing)?\\b"
      map_to: action:retain
    - match: "\\bdelete(s|d|ing)?\\b"
      map_to: action:delete

  purposes:
    - match: "analytics|measurement|metrics|insights"
      map_to: purpose:analytics
    - match: "advertising|ads|ad targeting|targeted advertising"
      map_to: purpose:advertising
    - match: "personalization|customization|recommendations"
      map_to: purpose:personalization
    - match: "security|fraud|abuse"
      map_to: purpose:security
    - match: "service provision|provide services|operate"
      map_to: purpose:service_provision
    - match: "legal|compliance|law"
      map_to: purpose:legal

  data_categories:
    - match: "advertising id|ad id"
      map_to: data:advertising_id
    - match: "cookie(s)?"
      map_to: data:cookie_id
    - match: "ip address|ip"
      map_to: data:ip_address
    - match: "precise location|geolocation"
      map_to: data:precise_location
    - match: "email address|email"
      map_to: data:email
    - match: "phone number|phone"
      map_to: data:phone
    - match: "payment|billing"
      map_to: data:payment
    - match: "usage data|activity"
      map_to: data:usage

  recipients:
    - match: "service provider|vendor|processor|sub-processor"
      map_to: recipient:service_provider
    - match: "analytics partner|analytics provider"
      map_to: recipient:analytics_provider
    - match: "advertising partner|advertiser"
      map_to: recipient:advertising_partner
    - match: "partner(s)?"
      map_to: recipient:partner

  legal_bases:
    - match: "consent|with consent"
      map_to: basis:consent
    - match: "legitimate interest(s)?"
      map_to: basis:legitimate_interest
    - match: "contract(ual)?"
      map_to: basis:contract
    - match: "legal obligation|required by law"
      map_to: basis:legal_obligation

  views:
    - match: "we do not|never"
      map_to: view:do_not
    - match: "only if|provided that"
      map_to: view:only_if
    - match: "may|might|can"
      map_to: view:may
    - match: "must|required"
      map_to: view:required

unknown_handling:
  strategy: keep_raw
  emit_under_specified: true
